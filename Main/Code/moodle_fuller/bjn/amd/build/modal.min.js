define(["jquery","jqueryui"],function(a){function b(a){return"<li class='sortable-item' data-email='"+a.email+"'><img src='"+a.picurl+"' height='35' width='35'>"+a.name+"</li>"}function c(a,b,c){var d=a.offset();a.appendTo(b);var e=a.offset(),f=a.clone().appendTo("body");f.css("position","absolute").css("left",d.left).css("top",d.top+45*c).css("zIndex",12e3),a.hide(),f.animate({top:e.top+45*c,left:e.left},250,function(){a.show(),f.remove()})}var d={};return d.init=function(d){a("input[name=attendees]").val()?a("#id_submitbutton").prop("disabled",!1):a("#id_submitbutton").prop("disabled",!0);var e=a("input[name=attendees]").val().split(",");a.each(d,function(c,d){a.inArray(d.email,e)>-1?a("#going").append(b(d)):a("#notgoing").append(b(d))}),a("#userlists .sortable-list").sortable({connectWith:"#userlists .sortable-list"}),a("#save").click(function(b){b.preventDefault();var c=[];a("#going li").each(function(){c.push(a(this).data("email"))}),a("input[name=attendees]").val(c),a("#attendeesModal").modal("toggle"),a("input[name=attendees]").val()?a("#id_submitbutton").prop("disabled",!1):a("#id_submitbutton").prop("disabled",!0)}),a("#select-all").click(function(b){var d=a("#notgoing li"),e=a("#going li");d.each(function(b,d){if(b<=4-e.length)c(a(this),a("#going"),b);else{var f=a(this);f.hide(),f.appendTo(a("#going")),setTimeout(function(){f.show()},250)}})}),a("#deselect-all").click(function(b){var d=a("#notgoing li"),e=a("#going li");e.each(function(b,e){if(b<=4-d.length)c(a(this),a("#notgoing"),b);else{var f=a(this);f.hide(),f.appendTo(a("#notgoing")),setTimeout(function(){f.show()},250)}})})},d});